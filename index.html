<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Taxi Platino App</title>
    
    <meta name="theme-color" content="#1B2A41">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Taxi Platino">
    <link rel="apple-touch-icon" href="logo.png">
    
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="logo.png">

    <style>
        :root {
            --navy: #1B2A41;
            --dark-navy: #0F1A2A;
            --silver: #E0E0E0;
            --red: #D32F2F;
            --gold: #FFD700;
            --bg: #f4f6f8;
        }
        
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--navy);
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* --- ZONA SUPERIOR (RESULTADOS) --- */
        .top-display {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            color: white;
            text-align: center;
            position: relative;
            background: linear-gradient(180deg, var(--navy) 0%, var(--dark-navy) 100%);
            transition: all 0.3s ease;
        }

        .brand-title {
            font-size: 28px;
            font-weight: 900;
            letter-spacing: 2px;
            text-transform: uppercase;
            color: rgba(255,255,255,0.9);
            margin-bottom: 5px;
        }
        .brand-subtitle {
            font-size: 12px;
            color: rgba(255,255,255,0.5);
            letter-spacing: 1px;
        }

        .result-container {
            display: none;
            animation: fadeIn 0.4s ease-out;
            width: 100%;
        }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }

        .price-big {
            font-size: 70px;
            font-weight: 800;
            color: white;
            line-height: 1;
            text-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }
        .price-label {
            font-size: 14px;
            color: var(--gold);
            font-weight: bold;
            text-transform: uppercase;
            margin-bottom: 10px;
        }
        .route-details {
            margin-top: 15px;
            background: rgba(255,255,255,0.1);
            padding: 10px 15px;
            border-radius: 10px;
            font-size: 13px;
            color: #ddd;
            backdrop-filter: blur(5px);
        }
        
        .close-result {
            position: absolute;
            top: 40px; 
            right: 20px;
            background: rgba(255,255,255,0.2);
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: none;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 10;
        }

        /* --- ZONA INFERIOR (CONTROLES) --- */
        .bottom-sheet {
            background: white;
            border-radius: 24px 24px 0 0;
            padding: 25px 20px calc(25px + env(safe-area-inset-bottom)) 20px;
            box-shadow: 0 -4px 25px rgba(0,0,0,0.2);
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-height: 70vh;
            overflow-y: auto;
            z-index: 100;
            position: relative;
        }

        .input-group { position: relative; }
        .input-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 16px;
        }
        input[type="text"] {
            width: 100%;
            padding: 16px 16px 16px 40px;
            border: 1px solid #eee;
            background: #f8f9fa;
            border-radius: 12px;
            font-size: 16px;
            color: #333;
            transition: all 0.2s;
            -webkit-appearance: none;
        }
        input[type="text"]:focus {
            outline: none;
            background: white;
            border-color: var(--navy);
        }

        /* --- BOT√ìN SWAP --- */
        .swap-container {
            position: absolute;
            right: 35px;
            top: 72px; /* Ajustado para estar entre los dos inputs */
            z-index: 101;
        }
        .btn-swap {
            background: var(--navy);
            color: white;
            border: 3px solid white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            transition: transform 0.3s ease;
        }
        .btn-swap:active { transform: scale(0.9) rotate(180deg); }

        .extras-scroll {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding: 5px 0;
        }
        .extra-chip {
            flex: 0 0 auto;
            border: 1px solid #eee;
            background: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            color: #555;
            cursor: pointer;
        }
        .extra-chip.active {
            background: var(--navy);
            color: white;
            border-color: var(--navy);
        }

        .btn-cotizar {
            width: 100%;
            background: var(--red);
            color: white;
            padding: 18px;
            border: none;
            border-radius: 14px;
            font-size: 18px;
            font-weight: 800;
            text-transform: uppercase;
            cursor: pointer;
            margin-top: 5px;
        }

        .btn-wa {
            background: #25D366;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 12px;
            font-weight: bold;
            width: 100%;
            cursor: pointer;
            margin-top: 15px;
            font-size: 16px;
        }

        .error-msg {
            color: #ff8a80;
            font-size: 13px;
            margin-top: 10px;
            display: none;
            font-weight: 500;
        }
    </style>
</head>
<body>

    <div class="top-display" id="display-area">
        <div class="close-result" id="btn-reset" onclick="limpiar()">‚úï</div>

        <div id="welcome-view">
            <div class="brand-title">TAXI PLATINO</div>
            <div class="brand-subtitle">COTIZADOR OFICIAL 2026</div>
            <div id="error-display" class="error-msg"></div>
        </div>

        <div id="result-view" class="result-container">
            <div class="price-label">Total Estimado</div>
            <div class="price-big" id="precio-display">$0</div>
            <div class="route-details" id="precio-info">...</div>
        </div>
    </div>

    <div class="bottom-sheet">
        <div class="swap-container">
            <div class="btn-swap" onclick="swapRuta()">‚áÖ</div>
        </div>

        <div class="input-group">
            <span class="input-icon">üìç</span>
            <input type="text" id="input-origen" list="list-colonias" placeholder="¬øD√≥nde est√°s?" autocomplete="off">
        </div>

        <div class="input-group">
            <span class="input-icon">üèÅ</span>
            <input type="text" id="input-destino" list="list-colonias" placeholder="¬øA d√≥nde vas?" autocomplete="off">
        </div>

        <datalist id="list-colonias"></datalist>

        <div style="font-size:11px; font-weight:bold; color:#888; text-transform:uppercase; margin-top:5px;">Adicionales</div>
        <div class="extras-scroll">
            <div class="extra-chip" onclick="toggleExtra(this, 30)">üõçÔ∏è Compras <span>+$30</span></div>
            <div class="extra-chip" onclick="toggleExtra(this, 30)">üè© Motel <span>+$30</span></div>
            <div class="extra-chip" onclick="toggleExtra(this, 20)">üè® Hotel <span>+$20</span></div>
        </div>

        <button class="btn-cotizar" onclick="cotizar()">Calcular Viaje</button>
    </div>

<script>
    // Matriz de Tarifas y Colonias (Mantenidos igual que el original)
    const tarifas = {
        "1": {"1":40,"1A":45,"1B":60,"1C":65,"2":40,"2A":45,"3":50,"3A":55,"3B":60,"3C":70,"4":55,"5":60,"5A":60,"6":75,"7":80,"7A":85,"8":85,"8A":90,"9":65,"9A":70,"9B":90,"9C":95,"10":60,"10A":60,"10B":70,"11":55,"12":60,"13":65,"13A":80,"14":150,"15":150,"16":80,"17":60,"18":80,"19":100,"20":100},
        "1A": {"1":45,"1A":45,"1B":65,"1C":75,"2":45,"2A":50,"3":55,"3A":55,"3B":60,"3C":70,"4":60,"5":65,"5A":65,"6":80,"7":85,"7A":90,"8":90,"8A":100,"9":70,"9A":80,"9B":90,"9C":100,"10":65,"10A":65,"10B":75,"11":60,"12":65,"13":70,"13A":80,"14":150,"15":150,"16":80,"17":60,"18":80,"19":100,"20":100},
        "1B": {"1":60,"1A":65,"1B":50,"1C":70,"2":65,"2A":70,"3":75,"3A":75,"3B":85,"3C":90,"4":80,"5":90,"5A":90,"6":90,"7":90,"7A":95,"8":90,"8A":90,"9":70,"9A":70,"9B":85,"9C":90,"10":70,"10A":60,"10B":60,"11":75,"12":80,"13":75,"13A":80,"14":150,"15":150,"16":80,"17":60,"18":80,"19":100,"20":90},
        "1C": {"1":65,"1A":75,"1B":70,"1C":70,"2":70,"2A":80,"3":80,"3A":80,"3B":90,"3C":100,"4":85,"5":95,"5A":95,"6":95,"7":95,"7A":95,"8":90,"8A":100,"9":75,"9A":75,"9B":85,"9C":95,"10":80,"10A":80,"10B":80,"11":85,"12":85,"13":80,"13A":85,"14":150,"15":150,"16":85,"17":70,"18":80,"19":100,"20":90},
        "2": {"1":40,"1A":45,"1B":65,"1C":70,"2":40,"2A":40,"3":45,"3A":45,"3B":50,"3C":60,"4":50,"5":55,"5A":55,"6":70,"7":75,"7A":80,"8":80,"8A":85,"9":55,"9A":65,"9B":85,"9C":95,"10":50,"10A":50,"10B":60,"11":50,"12":55,"13":60,"13A":75,"14":150,"15":150,"16":85,"17":60,"18":80,"19":100,"20":100},
        "2A": {"1":45,"1A":50,"1B":70,"1C":80,"2":40,"2A":40,"3":40,"3A":45,"3B":50,"3C":55,"4":40,"5":50,"5A":50,"6":60,"7":65,"7A":70,"8":75,"8A":80,"9":50,"9A":65,"9B":85,"9C":95,"10":50,"10A":50,"10B":60,"11":40,"12":50,"13":55,"13A":70,"14":150,"15":150,"16":85,"17":65,"18":85,"19":110,"20":100},
        "3": {"1":50,"1A":55,"1B":75,"1C":80,"2":45,"2A":40,"3":40,"3A":40,"3B":45,"3C":50,"4":50,"5":55,"5A":55,"6":70,"7":70,"7A":80,"8":80,"8A":90,"9":60,"9A":80,"9B":90,"9C":100,"10":55,"10A":60,"10B":65,"11":50,"12":55,"13":60,"13A":70,"14":160,"15":160,"16":90,"17":70,"18":90,"19":110,"20":110},
        "3A": {"1":55,"1A":55,"1B":75,"1C":80,"2":45,"2A":45,"3":40,"3A":40,"3B":45,"3C":50,"4":55,"5":60,"5A":60,"6":70,"7":75,"7A":80,"8":80,"8A":90,"9":60,"9A":75,"9B":85,"9C":100,"10":55,"10A":60,"10B":70,"11":55,"12":60,"13":65,"13A":75,"14":160,"15":160,"16":90,"17":80,"18":90,"19":110,"20":110},
        "3B": {"1":60,"1A":60,"1B":85,"1C":90,"2":50,"2A":50,"3":45,"3A":45,"3B":40,"3C":45,"4":50,"5":60,"5A":60,"6":70,"7":75,"7A":85,"8":85,"8A":95,"9":65,"9A":75,"9B":95,"9C":110,"10":65,"10A":65,"10B":75,"11":60,"12":65,"13":70,"13A":75,"14":160,"15":160,"16":90,"17":80,"18":95,"19":110,"20":110},
        "3C": {"1":70,"1A":70,"1B":90,"1C":100,"2":60,"2A":55,"3":50,"3A":50,"3B":45,"3C":45,"4":55,"5":65,"5A":65,"6":80,"7":80,"7A":90,"8":90,"8A":100,"9":75,"9A":80,"9B":100,"9C":120,"10":70,"10A":70,"10B":80,"11":65,"12":70,"13":75,"13A":85,"14":170,"15":170,"16":100,"17":80,"18":120,"19":120,"20":110},
        "4": {"1":55,"1A":55,"1B":80,"1C":85,"2":50,"2A":40,"3":50,"3A":55,"3B":50,"3C":55,"4":40,"5":40,"5A":40,"6":50,"7":55,"7A":60,"8":70,"8A":80,"9":60,"9A":70,"9B":90,"9C":100,"10":50,"10A":60,"10B":65,"11":40,"12":40,"13":55,"13A":60,"14":160,"15":160,"16":100,"17":80,"18":100,"19":120,"20":120},
        "5": {"1":60,"1A":65,"1B":90,"1C":95,"2":55,"2A":50,"3":55,"3A":60,"3B":60,"3C":65,"4":40,"5":40,"5A":40,"6":40,"7":45,"7A":50,"8":60,"8A":70,"9":60,"9A":70,"9B":85,"9C":100,"10":50,"10A":60,"10B":65,"11":45,"12":40,"13":45,"13A":50,"14":170,"15":170,"16":100,"17":85,"18":100,"19":130,"20":130},
        "5A": {"1":60,"1A":65,"1B":90,"1C":95,"2":55,"2A":50,"3":55,"3A":60,"3B":60,"3C":65,"4":40,"5":40,"5A":40,"6":45,"7":50,"7A":55,"8":65,"8A":80,"9":65,"9A":70,"9B":90,"9C":100,"10":55,"10A":60,"10B":70,"11":45,"12":45,"13":50,"13A":55,"14":170,"15":170,"16":100,"17":85,"18":100,"19":130,"20":130},
        "6": {"1":75,"1A":80,"1B":90,"1C":95,"2":70,"2A":60,"3":70,"3A":70,"3B":70,"3C":80,"4":50,"5":40,"5A":45,"6":40,"7":40,"7A":45,"8":50,"8A":60,"9":60,"9A":70,"9B":85,"9C":100,"10":50,"10A":60,"10B":70,"11":50,"12":45,"13":45,"13A":50,"14":170,"15":170,"16":120,"17":95,"18":120,"19":140,"20":140},
        "7": {"1":80,"1A":85,"1B":90,"1C":95,"2":75,"2A":65,"3":70,"3A":75,"3B":75,"3C":80,"4":55,"5":45,"5A":50,"6":40,"7":40,"7A":40,"8":50,"8A":55,"9":60,"9A":70,"9B":85,"9C":100,"10":50,"10A":60,"10B":70,"11":50,"12":45,"13":45,"13A":45,"14":180,"15":180,"16":120,"17":95,"18":120,"19":140,"20":140},
        "7A": {"1":85,"1A":90,"1B":95,"1C":95,"2":80,"2A":70,"3":80,"3A":80,"3B":85,"3C":90,"4":60,"5":50,"5A":55,"6":45,"7":40,"7A":40,"8":50,"8A":60,"9":65,"9A":75,"9B":90,"9C":100,"10":55,"10A":65,"10B":75,"11":55,"12":50,"13":50,"13A":50,"14":180,"15":180,"16":120,"17":95,"18":120,"19":140,"20":140},
        "8": {"1":85,"1A":90,"1B":90,"1C":90,"2":75,"2A":75,"3":80,"3A":80,"3B":85,"3C":90,"4":70,"5":60,"5A":65,"6":50,"7":50,"7A":50,"8":40,"8A":50,"9":65,"9A":70,"9B":75,"9C":95,"10":60,"10A":65,"10B":70,"11":65,"12":60,"13":60,"13A":55,"14":180,"15":180,"16":120,"17":95,"18":120,"19":140,"20":140},
        "8A": {"1":90,"1A":100,"1B":90,"1C":100,"2":85,"2A":80,"3":90,"3A":90,"3B":95,"3C":100,"4":80,"5":70,"5A":80,"6":60,"7":55,"7A":60,"8":50,"8A":50,"9":70,"9A":70,"9B":75,"9C":90,"10":70,"10A":70,"10B":75,"11":70,"12":65,"13":65,"13A":60,"14":170,"15":170,"16":110,"17":95,"18":120,"19":140,"20":140},
        "9": {"1":65,"1A":70,"1B":70,"1C":75,"2":55,"2A":50,"3":60,"3A":60,"3B":65,"3C":75,"4":60,"5":60,"5A":65,"6":60,"7":60,"7A":65,"8":65,"8A":70,"9":40,"9A":45,"9B":70,"9C":80,"10":45,"10A":45,"10B":50,"11":55,"12":55,"13":45,"13A":55,"14":160,"15":160,"16":90,"17":85,"18":95,"19":120,"20":120},
        "9A": {"1":70,"1A":80,"1B":70,"1C":75,"2":65,"2A":65,"3":80,"3A":75,"3B":75,"3C":80,"4":70,"5":70,"5A":70,"6":70,"7":70,"7A":75,"8":70,"8A":70,"9":45,"9A":50,"9B":70,"9C":80,"10":55,"10A":50,"10B":50,"11":60,"12":60,"13":55,"13A":60,"14":160,"15":160,"16":95,"17":85,"18":95,"19":120,"20":120},
        "9B": {"1":90,"1A":90,"1B":85,"1C":85,"2":85,"2A":85,"3":90,"3A":85,"3B":95,"3C":100,"4":90,"5":85,"5A":90,"6":85,"7":85,"7A":90,"8":75,"8A":75,"9":70,"9A":70,"9B":70,"9C":80,"10":75,"10A":75,"10B":75,"11":80,"12":80,"13":75,"13A":75,"14":170,"15":170,"16":120,"17":90,"18":120,"19":130,"20":130},
        "9C": {"1":95,"1A":100,"1B":90,"1C":95,"2":95,"2A":95,"3":100,"3A":100,"3B":110,"3C":120,"4":90,"5":100,"5A":100,"6":100,"7":100,"7A":100,"8":95,"8A":90,"9":80,"9A":80,"9B":80,"9C":80,"10":85,"10A":85,"10B":85,"11":90,"12":90,"13":90,"13A":85,"14":180,"15":180,"16":130,"17":100,"18":130,"19":140,"20":130},
        "10": {"1":60,"1A":65,"1B":70,"1C":80,"2":50,"2A":50,"3":55,"3A":55,"3B":65,"3C":70,"4":50,"5":50,"5A":55,"6":50,"7":50,"7A":55,"8":60,"8A":70,"9":45,"9A":55,"9B":75,"9C":85,"10":40,"10A":45,"10B":50,"11":45,"12":45,"13":40,"13A":50,"14":150,"15":150,"16":100,"17":85,"18":100,"19":120,"20":120},
        "10A": {"1":60,"1A":65,"1B":60,"1C":80,"2":50,"2A":50,"3":60,"3A":60,"3B":65,"3C":70,"4":60,"5":60,"5A":60,"6":60,"7":60,"7A":65,"8":65,"8A":70,"9":45,"9A":50,"9B":75,"9C":85,"10":45,"10A":45,"10B":50,"11":50,"12":50,"13":45,"13A":55,"14":160,"15":160,"16":100,"17":85,"18":100,"19":120,"20":120},
        "10B": {"1":70,"1A":75,"1B":60,"1C":80,"2":60,"2A":60,"3":65,"3A":70,"3B":75,"3C":80,"4":65,"5":65,"5A":70,"6":70,"7":70,"7A":75,"8":70,"8A":75,"9":50,"9A":50,"9B":75,"9C":85,"10":50,"10A":50,"10B":50,"11":55,"12":55,"13":50,"13A":65,"14":170,"15":170,"16":100,"17":90,"18":100,"19":120,"20":120},
        "11": {"1":55,"1A":60,"1B":75,"1C":85,"2":50,"2A":40,"3":50,"3A":55,"3B":60,"3C":65,"4":40,"5":45,"5A":45,"6":50,"7":50,"7A":55,"8":65,"8A":70,"9":55,"9A":60,"9B":80,"9C":90,"10":45,"10A":50,"10B":55,"11":40,"12":40,"13":45,"13A":60,"14":160,"15":160,"16":100,"17":80,"18":100,"19":120,"20":120},
        "12": {"1":60,"1A":65,"1B":80,"1C":85,"2":55,"2A":50,"3":55,"3A":60,"3B":65,"3C":70,"4":40,"5":40,"5A":45,"6":45,"7":45,"7A":50,"8":60,"8A":65,"9":55,"9A":60,"9B":80,"9C":90,"10":45,"10A":50,"10B":55,"11":40,"12":40,"13":40,"13A":50,"14":170,"15":170,"16":100,"17":85,"18":100,"19":120,"20":120},
        "13": {"1":65,"1A":70,"1B":75,"1C":80,"2":60,"2A":55,"3":60,"3A":65,"3B":70,"3C":75,"4":55,"5":45,"5A":50,"6":45,"7":45,"7A":50,"8":60,"8A":65,"9":45,"9A":55,"9B":75,"9C":90,"10":40,"10A":45,"10B":50,"11":40,"12":40,"13":40,"13A":45,"14":170,"15":170,"16":100,"17":90,"18":100,"19":120,"20":120},
        "13A": {"1":80,"1A":80,"1B":80,"1C":85,"2":75,"2A":70,"3":70,"3A":75,"3B":75,"3C":85,"4":60,"5":50,"5A":55,"6":50,"7":45,"7A":50,"8":55,"8A":60,"9":55,"9A":60,"9B":75,"9C":85,"10":50,"10A":55,"10B":65,"11":60,"12":50,"13":45,"13A":45,"14":170,"15":160,"16":120,"17":95,"18":110,"19":130,"20":140},
        "14": {"1":150,"1A":150,"1B":150,"1C":150,"2":150,"2A":150,"3":160,"3A":160,"3B":160,"3C":170,"4":160,"5":170,"5A":170,"6":170,"7":180,"7A":180,"8":180,"8A":170,"9":160,"9A":160,"9B":170,"9C":180,"10":150,"10A":160,"10B":170,"11":140,"12":170,"13":170,"13A":170,"14":150,"15":150,"16":150,"17":150,"18":150,"19":150,"20":150},
        "15": {"1":150,"1A":150,"1B":150,"1C":150,"2":150,"2A":150,"3":160,"3A":160,"3B":160,"3C":170,"4":160,"5":170,"5A":170,"6":170,"7":180,"7A":180,"8":180,"8A":170,"9":160,"9A":160,"9B":170,"9C":180,"10":150,"10A":160,"10B":170,"11":130,"12":170,"13":170,"13A":160,"14":150,"15":150,"16":130,"17":130,"18":130,"19":130,"20":150},
        "16": {"1":80,"1A":80,"1B":80,"1C":85,"2":85,"2A":85,"3":90,"3A":90,"3B":90,"3C":100,"4":100,"5":100,"5A":100,"6":120,"7":120,"7A":120,"8":120,"8A":110,"9":90,"9A":95,"9B":120,"9C":130,"10":100,"10A":100,"10B":100,"11":90,"12":100,"13":100,"13A":120,"14":150,"15":130,"16":60,"17":80,"18":80,"19":95,"20":150},
        "17": {"1":60,"1A":60,"1B":60,"1C":70,"2":60,"2A":65,"3":70,"3A":80,"3B":80,"3C":80,"4":80,"5":85,"5A":85,"6":95,"7":95,"7A":95,"8":95,"8A":95,"9":85,"9A":85,"9B":90,"9C":100,"10":85,"10A":85,"10B":90,"11":80,"12":85,"13":90,"13A":95,"14":150,"15":130,"16":80,"17":60,"18":80,"19":100,"20":100},
        "18": {"1":80,"1A":80,"1B":80,"1C":80,"2":80,"2A":85,"3":90,"3A":90,"3B":95,"3C":120,"4":100,"5":100,"5A":100,"6":120,"7":120,"7A":120,"8":120,"8A":120,"9":95,"9A":95,"9B":120,"9C":130,"10":100,"10A":100,"10B":100,"11":90,"12":100,"13":100,"13A":110,"14":150,"15":130,"16":80,"17":80,"18":80,"19":100,"20":100},
        "19": {"1":100,"1A":100,"1B":100,"1C":100,"2":100,"2A":110,"3":110,"3A":110,"3B":110,"3C":120,"4":120,"5":130,"5A":130,"6":140,"7":140,"7A":140,"8":140,"8A":140,"9":120,"9A":120,"9B":130,"9C":140,"10":120,"10A":120,"10B":120,"11":110,"12":120,"13":120,"13A":130,"14":150,"15":130,"16":95,"17":100,"18":100,"19":100,"20":150},
        "20": {"1":100,"1A":100,"1B":90,"1C":90,"2":100,"2A":100,"3":110,"3A":110,"3B":110,"3C":110,"4":120,"5":130,"5A":130,"6":140,"7":140,"7A":140,"8":140,"8A":140,"9":120,"9A":120,"9B":130,"9C":130,"10":120,"10A":120,"10B":120,"11":110,"12":120,"13":120,"13A":140,"14":150,"15":150,"16":150,"17":100,"18":100,"19":150,"20":100}
    };

    const coloniasData = [
        {"n":"TLALCUALOYA", "s":"1"}, {"n":"UN PASO A LA GLORIA", "s":"1A"},
        {"n":"CHICHONAL", "s":"1A"}, {"n":"8 DE MAYO", "s":"1C"},
        {"n":"ROSALINDA", "s":"2"}, {"n":"GUAYACANAL", "s":"3"},
        {"n":"OBRERA", "s":"6"}, {"n":"INSURGENTES NTE", "s":"1"},
        {"n":"FOVISSTE", "s":"1A"}, {"n":"PATRIA LIBRE 2 SECC", "s":"1C"},
        {"n":"INSURGENTES SUR", "s":"2"}, {"n":"COL.HIDALGO", "s":"3"},
        {"n":"RUIZ CORTINES", "s":"4"}, {"n":"POPULAR", "s":"5A"},
        {"n":"LAS DELICIAS", "s":"1"}, {"n":"F.GUTIERREZ", "s":"1A"},
        {"n":"FCO I. MADERO (1C)", "s":"1C"}, {"n":"FRACC. CRISTAL", "s":"2"},
        {"n":"MARTIRES DE CHICAGO", "s":"3"}, {"n":"PALMAR", "s":"4"},
        {"n":"16 DE SEPTIEMBRE", "s":"1"}, {"n":"CERRO ALTO", "s":"1A"},
        {"n":"VERACRUZ", "s":"1C"}, {"n":"LAS FUENTES", "s":"2"},
        {"n":"FRACC. CASINO", "s":"3"}, {"n":"AURORA", "s":"4"},
        {"n":"LUIS ECHEVERRIA", "s":"1"}, {"n":"BENITO JUAREZ", "s":"1"},
        {"n":"EL ENCINAL", "s":"1C"}, {"n":"CENTRO", "s":"5"},
        {"n":"JARDINES DE TLACUALEYA", "s":"1"}, {"n":"EL MANGAL", "s":"1"},
        {"n":"SALINAS DE GORTARI", "s":"1B"}, {"n":"CUALIPAN", "s":"2A"},
        {"n":"VILLAS DEL SOL", "s":"3A"}, {"n":"VICENTE GUERRERO", "s":"3B"},
        {"n":"FCO I, MADERO (3B)", "s":"3B"}, {"n":"PLAYON", "s":"5"},
        {"n":"GUAYABAL", "s":"5"}, {"n":"CUAHUTEMOC", "s":"7"},
        {"n":"ESMERALDA", "s":"1"}, {"n":"PATRIA LIBRE 1 SECC", "s":"1B"},
        {"n":"NUEVA MINA SUR", "s":"2A"}, {"n":"NUEVA ESPERANZA", "s":"3B"},
        {"n":"FRAMBOYAN", "s":"1"}, {"n":"JAGUEY", "s":"3C"},
        {"n":"FRACC, FLORESTA", "s":"3B"}, {"n":"GRAVERA", "s":"7A"},
        {"n":"AMPLIACION HIDALGO", "s":"3B"}, {"n":"SERGIO MARTINEZ", "s":"7A"},
        {"n":"PRADERAS DEL JAGUEY", "s":"3B"}, {"n":"EJIDO TACOTENO", "s":"8"},
        {"n":"INFONAVIT", "s":"9"}, {"n":"MAPACHAPA", "s":"9C"},
        {"n":"BUENA VISTA SUR", "s":"11"}, {"n":"LOS MANGOS", "s":"14"},
        {"n":"REST. LAS FLORES", "s":"17"}, {"n":"COLOSIO", "s":"19"},
        {"n":"SALUBRIDAD", "s":"8"}, {"n":"SEBASTIAN", "s":"8"},
        {"n":"AGUSTIN MELGAR 1A", "s":"9"}, {"n":"NUEVA MINA NORTE", "s":"11"},
        {"n":"STA. CLARA PTE.", "s":"11"}, {"n":"VILLAS DEL VERGEL", "s":"14"},
        {"n":"EL ARENAL", "s":"14"}, {"n":"LOS ARCOS", "s":"17"},
        {"n":"MARTIN LANCERO", "s":"17"}, {"n":"FRACC. ARBOLEDAS", "s":"19"},
        {"n":"SEC.FEDERAL 1", "s":"8"}, {"n":"AGUSTIN MELGAR 2A", "s":"9A"},
        {"n":"BUENA VISTA NORTE", "s":"10"}, {"n":"BOHEMIA", "s":"11"},
        {"n":"CHAPALA", "s":"11"}, {"n":"GUTIERREZ BARRIOS", "s":"14"},
        {"n":"C-4", "s":"17"}, {"n":"J. DE LAS FLORES", "s":"17"},
        {"n":"CIRILO VAZQUEZ", "s":"20"}, {"n":"COL. MEXICO", "s":"9A"},
        {"n":"SAN CARLOS", "s":"10"}, {"n":"SANTO DOMINGO", "s":"11"},
        {"n":"LAS PALMITAS", "s":"20"}, {"n":"DIVISION DEL NORTE", "s":"9A"},
        {"n":"L. DE SAN AGUSTIN", "s":"15"}, {"n":"CEISA", "s":"20"},
        {"n":"COSTA DE MARFIL", "s":"8A"}, {"n":"COL, AZTECA", "s":"9A"},
        {"n":"RESID. MONTE ALTO", "s":"15"}, {"n":"LAS ROSAS", "s":"18"},
        {"n":"EJIDO LA BOMBA", "s":"20"}, {"n":"ARRIOJA", "s":"8A"},
        {"n":"DIAZ ORDAZ 1A", "s":"10A"}, {"n":"NUEVA TACOTENO", "s":"12"},
        {"n":"SAN PEDRO MARTIR", "s":"15"}, {"n":"NARANJITO", "s":"18"},
        {"n":"ZACATAL", "s":"20"}, {"n":"BASURERO ORIENTE", "s":"8A"},
        {"n":"OAXAQUE√ëA", "s":"10A"}, {"n":"DIAZ ORDAZ 2A", "s":"10B"},
        {"n":"STA. CLARA OTE", "s":"12"}, {"n":"ALDANA", "s":"18"},
        {"n":"ENCINO GORDO", "s":"20"}, {"n":"PORSA", "s":"8A"},
        {"n":"SUBESTACION", "s":"8A"}, {"n":"EMILIANO ZAPATA", "s":"9B"},
        {"n":"CONGRESO", "s":"9B"}, {"n":"7 DE MAYO", "s":"10A"},
        {"n":"PECOSA", "s":"10A"}, {"n":"JARD. DEL BOSQUE", "s":"16"},
        {"n":"LA VERONICA", "s":"18"}, {"n":"LOS ENCINOS", "s":"18"},
        {"n":"JOSEFA OLIVARES", "s":"8A"}, {"n":"BASURERO PONIENTE", "s":"9B"},
        {"n":"20 DE NOVIEMBRE", "s":"13"}, {"n":"SECCION 32", "s":"16"},
        {"n":"JACARANDAS", "s":"18"}, {"n":"PROL. SAN FRANCISCO", "s":"8A"},
        {"n":"GUADALUPANA", "s":"8A"}, {"n":"10 DE MAYO", "s":"9B"},
        {"n":"SAN ANTONIO", "s":"9B"}, {"n":"DE LOS MAESTRO", "s":"13"}, {"n":"COL. PETROLERA", "s":"13"},
        {"n":"PLANTA DE THINER", "s":"16"}, {"n":"LOS NARANJOS", "s":"16"},
        {"n":"DIEZ", "s":"18"}, {"n":"LOS COCOS", "s":"18"},
        {"n":"DIANA LAURA", "s":"8A"}, {"n":"COL CO2 LIQUID", "s":"10B"},
        {"n":"NI√ëOS HEROES", "s":"10B"}, {"n":"EDUARDO SOTO", "s":"13A"},
        {"n":"COSOLEACAQUE", "s":"14"}
    ];

    // Registro de Service Worker
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('./sw.js')
            .then(() => console.log("Service Worker registrado"))
            .catch(err => console.log("Error SW:", err));
    }

    // Cargar Datalist ordenado
    const dataList = document.getElementById('list-colonias');
    coloniasData.sort((a, b) => a.n.localeCompare(b.n));
    dataList.innerHTML = coloniasData.map(c => `<option value="${c.n}">`).join('');

    let extraTotal = 0;
    let costoFinalCalculado = 0;

    function toggleExtra(btn, costo) {
        btn.classList.toggle('active');
        extraTotal += btn.classList.contains('active') ? costo : -costo;
    }

    function getSector(nombre) {
        if (!nombre) return null;
        const found = coloniasData.find(c => c.n.toUpperCase() === nombre.trim().toUpperCase());
        return found ? found.s : null;
    }

    function showError(msg) {
        const errDiv = document.getElementById('error-display');
        errDiv.innerText = msg;
        errDiv.style.display = 'block';
        setTimeout(() => { errDiv.style.display = 'none'; }, 3500);
    }

    function swapRuta() {
        const inputO = document.getElementById('input-origen');
        const inputD = document.getElementById('input-destino');
        const temp = inputO.value;
        inputO.value = inputD.value;
        inputD.value = temp;
    }

    function cotizar() {
        const origen = document.getElementById('input-origen').value;
        const destino = document.getElementById('input-destino').value;
        const secO = getSector(origen);
        const secD = getSector(destino);

        if (!secO || !secD) {
            showError("‚ö†Ô∏è Selecciona colonias v√°lidas de la lista.");
            return;
        }

        let precioBase = 0;
        if (tarifas[secO] && tarifas[secO][secD]) {
            precioBase = tarifas[secO][secD];
        } else if (tarifas[secD] && tarifas[secD][secO]) {
            precioBase = tarifas[secD][secO];
        }
        
        if (precioBase === 0 && (secO === "14" || secD === "14")) precioBase = 150;

        if (precioBase > 0) {
            costoFinalCalculado = precioBase + extraTotal;
            
            document.getElementById('welcome-view').style.display = 'none';
            document.getElementById('result-view').style.display = 'block';
            document.getElementById('btn-reset').style.display = 'flex';

            document.getElementById('precio-display').innerText = `$${costoFinalCalculado}`;
            
            let detalle = `<strong>${origen}</strong> <br> ‚ûù <br> <strong>${destino}</strong>`;
            if (extraTotal > 0) detalle += `<br><small style="color:var(--gold)">(Incluye +$${extraTotal} en extras)</small>`;
            detalle += `<button class="btn-wa" onclick="enviarWA('${origen}', '${destino}')">üì± Solicitar por WhatsApp</button>`;
            
            document.getElementById('precio-info').innerHTML = detalle;
        } else {
            showError("‚ùå Ruta no encontrada en el sistema.");
        }
    }

    function enviarWA(o, d) {
        const tel = "529222085150";
        const msg = encodeURIComponent(`üöï *Nuevo Servicio*\nüìç *Origen:* ${o}\nüèÅ *Destino:* ${d}\nüí∞ *Precio:* $${costoFinalCalculado}\n\n¬øUnidad disponible?`);
        window.open(`https://wa.me/${tel}?text=${msg}`, '_blank');
    }

    function limpiar() {
        document.getElementById('input-origen').value = '';
        document.getElementById('input-destino').value = '';
        document.getElementById('welcome-view').style.display = 'block';
        document.getElementById('result-view').style.display = 'none';
        document.getElementById('btn-reset').style.display = 'none';
        extraTotal = 0;
        document.querySelectorAll('.extra-chip').forEach(b => b.classList.remove('active'));
    }
</script>
</body>
</html>
